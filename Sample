$namespace  = "airflow"
$pod        = "airflow-web-56cdb58cd6-rf56w"   # your pod
$localCert  = "C:/Users/tk270/apm0001970-ddm-ddm-datamesh/corp-ca.crt"
$tmpPath    = "/tmp/corp-ca.crt"

# stream the file into /tmp inside the pod (works even for non-root)
Get-Content -Raw -Encoding Byte $localCert | kubectl exec -i -n $namespace $pod -- sh -c "cat > $tmpPath && chmod 644 $tmpPath"

# verify it exists
kubectl -n $namespace exec $pod -- sh -c "ls -l $tmpPath || true"


kubectl -n $namespace exec $pod -- sh -c "chmod 644 $targetPath && if command -v update-ca-certificates >/dev/null 2>&1; then update-ca-certificates; else apk add --no-cache ca-certificates >/dev/null 2>&1 && update-ca-certificates; fi"

kubectl -n $namespace exec -it $pod -- curl -v https://pypi.org/simple/ --max-time 10
