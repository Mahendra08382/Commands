# find pod names
$web   = (kubectl get pods -n airflow --no-headers | Select-String "web" | ForEach-Object { ($_ -split '\s+')[0] } | Select-Object -First 1)
$sched = (kubectl get pods -n airflow --no-headers | Select-String "scheduler" | ForEach-Object { ($_ -split '\s+')[0] } | Select-Object -First 1)

# 1. Create tar of logs from scheduler (local file on your machine)
kubectl exec -n airflow $sched -- bash -c "cd /opt/airflow && tar czf - logs" > C:\Windows\temp\airflow-logs.tgz

# 2. Copy that tar into the web pod (note: namespace flag BEFORE args, local path quoted)
kubectl cp -n airflow "C:\Windows\temp\airflow-logs.tgz" "${web}:/tmp/airflow-logs.tgz"

# 3. Extract inside web pod
kubectl exec -n airflow $web -- bash -c "mkdir -p /opt/airflow && tar xzf /tmp/airflow-logs.tgz -C /opt/airflow && rm -f /tmp/airflow-logs.tgz"
