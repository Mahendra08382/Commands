# get a webserver pod name (adjust label if your chart used a different label)
WS=$(kubectl -n airflow get pod -l app.kubernetes.io/component=webserver -o jsonpath='{.items[0].metadata.name}')
echo "webserver pod: $WS"

# DNS resolution test
kubectl -n airflow exec $WS -- sh -c "nslookup airflow-scheduler || dig +short airflow-scheduler || host airflow-scheduler || true"

# HTTP test to scheduler log server
kubectl -n airflow exec $WS -- sh -c "curl -v --max-time 5 http://airflow-scheduler:8793/ || true"
