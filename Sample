# get pod names
$web   = (kubectl get pods -n airflow --no-headers | Select-String "web" | ForEach-Object { ($_ -split '\s+')[0] } | Select-Object -First 1)
$sched = (kubectl get pods -n airflow --no-headers | Select-String "scheduler" | ForEach-Object { ($_ -split '\s+')[0] } | Select-Object -First 1)

# create tar of logs locally
kubectl exec -n airflow $sched -- bash -c "cd /opt/airflow && tar czf - logs" > C:\Windows\temp\airflow-logs.tgz

# copy into web pod (PICK ONE of the following)
kubectl cp "C:\Windows\temp\airflow-logs.tgz" "$web:/tmp/airflow-logs.tgz" -n airflow
# OR
# kubectl cp "C:\Windows\temp\airflow-logs.tgz" "airflow/$web:/tmp/airflow-logs.tgz"

# extract inside web pod
kubectl exec -n airflow $web -- bash -c "mkdir -p /opt/airflow && tar xzf /tmp/airflow-logs.tgz -C /opt/airflow && rm -f /tmp/airflow-logs.tgz"
