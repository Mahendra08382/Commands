# create dir and hosts.toml that disables cert verification for registry.gitlab.com
minikube ssh "sudo mkdir -p /etc/containerd/certs.d/registry.gitlab.com"
minikube ssh "sudo tee /etc/containerd/certs.d/registry.gitlab.com/hosts.toml > /dev/null <<'EOF'
[host.\"https://registry.gitlab.com\"]
  skip_verify = true
EOF"
# restart containerd
minikube ssh "sudo systemctl restart containerd"
# test pull
minikube ssh "sudo ctr images pull registry.gitlab.com/<your-path>/<your-image>:<tag>"






 


# 1. Create registry config dir
minikube ssh "sudo mkdir -p /etc/containerd/certs.d/registry.gitlab.com"

# 2. Configure skip TLS verification
minikube ssh "sudo tee /etc/containerd/certs.d/registry.gitlab.com/hosts.toml > /dev/null <<'EOF'
[host.\"https://registry.gitlab.com\"]
  skip_verify = true
EOF"

# 3. Restart containerd
minikube ssh "sudo systemctl restart containerd"



minikube ssh "echo '{\"insecure-registries\":[\"registry.gitlab.com\"]}' | sudo tee /etc/docker/daemon.json"
minikube ssh "sudo systemctl restart docker"


minikube ssh "docker pull registry.gitlab.com/<your-path>/<your-image>:<tag>"
